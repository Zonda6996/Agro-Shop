generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

enum OrderStatus {
  PENDING
  PAID
  SHIPPED
  DELIVERED
  CANCELLED
}

model User {
	id Int @id @default(autoincrement())
	email String @unique
	password String
	name String?

	orders Order[]
}

model Product {
	id Int @id @default(autoincrement())
	categoryId Int
	name String
	description String?
	price Decimal @db.Decimal(10, 2)
	image String?
	stock Int

	category Category @relation(fields: [categoryId], references: [id])
	orderItems OrderItem[]
}

model Category {
	id Int @id @default(autoincrement())
	name String @unique

	products Product[]
}

model Order {
	id Int @id @default(autoincrement())
	userId Int
	total Decimal @db.Decimal(10, 2)
	status OrderStatus @default(PENDING)
	createdAt DateTime @default(now())

	user User @relation(fields: [userId], references: [id])
	items OrderItem[]
}

model OrderItem {
	id Int @id @default(autoincrement())
	orderId Int
	productId Int
	quantity Int
	price Decimal @db.Decimal(10, 2)

	order Order @relation(fields: [orderId], references: [id], onDelete: Cascade)
	product Product @relation(fields: [productId], references: [id])
}

